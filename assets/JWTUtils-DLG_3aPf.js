var m=Object.defineProperty;var g=(s,t,e)=>t in s?m(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var r=(s,t,e)=>g(s,typeof t!="symbol"?t+"":t,e);import{b0 as p,C as w}from"./index-f1YMPRds.js";class h{constructor(){r(this,"_jwt",localStorage.getItem("jwt"));r(this,"openModal",!1);r(this,"infoModal",!1);p(this)}set jwt(t){localStorage.setItem("jwt",t),this._jwt=t}get jwt(){return this._jwt}setOpenModal(t){this.openModal=t}setInfoModal(t){this.infoModal=t}clearJwt(){localStorage.removeItem("jwt"),localStorage.removeItem("backgroundImages"),this._jwt=null}}const o=new h;class I{static getToken(){return o.jwt}static parseJWT(t=this.getToken()){var e,n;if(!t)return null;try{const c=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),l=decodeURIComponent((n=(e=atob(c))==null?void 0:e.split("").map(u=>"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)))==null?void 0:n.join(""));return JSON.parse(l)}catch{o.clearJwt()}}static isExpired(t=this.parseJWT()){if(!t)return!0;const e=t.exp<Date.now()/1e3;return e&&o.clearJwt(),f(e),e}static getName(){var e;const t=this.parseJWT();return(t==null?void 0:t.username)||"ikun"+((e=t==null?void 0:t.userId)==null?void 0:e.substring(0,10))+"..."}static getId(){const t=this.parseJWT();return(t==null?void 0:t.userId)||"noLogin"}static getAvatar(){const t=this.parseJWT();return t==null?void 0:t.avatar}}let a=!0;const f=s=>{s&&a&&(setTimeout(()=>{w.msg.error("登录信息已失效，请重新登录。"),a=!1},500),setTimeout(()=>a=!0,1500))};export{I as J,o as U};
