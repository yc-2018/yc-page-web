import{a as r}from"./index-C0Zqfgkc.js";import{C as n}from"./index-A5yLZ6sE.js";import{U as c,J as i}from"./JWTUtils-vY2OjTKT.js";const p="https://yc556.cn/api",{msg:a}=n,l=async e=>{try{return(await o.get(e))?.data??{}}catch(s){return console.log(`%c${e}的get请求失败:`,"color: red;font-size: 20px;",s),{success:!1,code:0,msg:"get请求失败"}}},g=async(e,s)=>{try{return(await o.post(e,s))?.data??{}}catch(t){return console.log(`%c${e}的post请求失败:`,"color: red;font-size: 20px;",t),{success:!1,code:0,msg:"post请求失败"}}},x=async(e,s)=>{try{return(await o({url:e,method:"put",data:s}))?.data??{}}catch(t){return console.log(`%c${e}的put请求失败:`,"color: red;font-size: 20px;",t),{success:!1,code:0,msg:"put请求失败"}}},f=async(e,s)=>{try{return(await o({url:e,method:"delete",data:s}))?.data??{}}catch(t){return console.log(`%c${e}的delete请求失败:`,"color: red;font-size: 20px;",t),{success:!1,code:0,msg:"delete请求失败"}}},o=r.create({baseURL:p,timeout:1e4});o.interceptors.request.use(e=>{const s=c.jwt;return i.isExpired()?Promise.reject(new Error("Token expired")):(e.headers.Authorization=`Bearer ${s}`,e)},e=>Promise.reject(e));o.interceptors.response.use(e=>(e.data.code!==1&&a.error(e.data.msg),e),e=>{let s;return e.response&&e.response.status===401?(s="未登录或登录已过期，请重新登录。",window.location.href="/"):e.response&&e.response.status>400?s=`错误：${e.response.status} - ${e.response.data.message}`:e.message&&e.message.includes("timeout")?s="请求超时，请检查网络连接或稍后重试":s="网络错误，请检查您的网络连接",a.error(s),{code:0,msg:e.message}});export{l as a,o as b,f as c,x as d,p as e,g as m};
