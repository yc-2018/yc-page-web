import{r as u,J as O,j as e,B as m,C as G,R as J}from"./index-f1YMPRds.js";import{u as U,e as Q}from"./memoApi-DhbOTOup.js";import{d as k,R as V}from"./toolsRequest-C3uJLrxr.js";import{P as S}from"./index-BEIOo5xS.js";import{I as W,_ as X}from"./AntdIcon-DOlxDjpc.js";import{M as Y}from"./index-DiwL6sTj.js";import{R as p}from"./index-DjcRm9lm.js";import{I as Z}from"./index-BUIwELm1.js";import{D as B}from"./DateUtils-_0hZsMQ3.js";import{R as ee,C as te}from"./row-Dx7pK_Vw.js";var ne={icon:function(l,n){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z",fill:l}},{tag:"path",attrs:{d:"M512 140c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zM288 421a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm224 272c-85.5 0-155.6-67.3-160-151.6a8 8 0 018-8.4h48.1c4.2 0 7.8 3.2 8.1 7.4C420 589.9 461.5 629 512 629s92.1-39.1 95.8-88.6c.3-4.2 3.9-7.4 8.1-7.4H664a8 8 0 018 8.4C667.6 625.7 597.5 693 512 693zm176-224a48.01 48.01 0 010-96 48.01 48.01 0 010 96z",fill:n}},{tag:"path",attrs:{d:"M288 421a48 48 0 1096 0 48 48 0 10-96 0zm376 112h-48.1c-4.2 0-7.8 3.2-8.1 7.4-3.7 49.5-45.3 88.6-95.8 88.6s-92-39.1-95.8-88.6c-.3-4.2-3.9-7.4-8.1-7.4H360a8 8 0 00-8 8.4c4.4 84.3 74.5 151.6 160 151.6s155.6-67.3 160-151.6a8 8 0 00-8-8.4zm-24-112a48 48 0 1096 0 48 48 0 10-96 0z",fill:l}}]}},name:"smile",theme:"twotone"},se=function(l,n){return u.createElement(W,X({},l,{ref:n,icon:ne}))},oe=u.forwardRef(se);const re="_sign_zqq62_2",le="_externalImgModel_zqq62_11",M={sign:re,externalImgModel:le},{TextArea:ie}=Z,{msg:$}=G,ce=[{src:"https://playground.z.wiki/img-cloud/index.html",title:"外部图床1(可能失效,注意信息安全)"},{src:`${k}/聚合图床/`,title:"外部图床2(数据在外部，注意信息安全)"},{src:`${k}/官方图床/`,title:"官方图床3"}],ve=({isOpen:o,setOpen:l,data:n,reList:i,currentMemoType:f})=>{const[s,c]=u.useState(null),[j,C]=u.useState(!1),[E,h]=u.useState(!1),[R,x]=u.useState(!1),g=u.useRef(null),{modal:v}=O.useApp();u.useEffect(()=>{c(n||{content:null,itemType:f})},[n]),u.useEffect(()=>{o&&window.setTimeout(()=>{var t;return(t=g.current)==null?void 0:t.focus()},100)},[o]);const y=(t=!0)=>{s.content&&s.content!==(n==null?void 0:n.content)&&t?v.confirm({title:"检查到内容发送改变",content:"是否确定不保存内容直接关闭编辑框？",okText:"确认关闭",onOk:r}):r();function r(){x(!1),h(!1),window.setTimeout(()=>l(!1),100)}},I=async()=>{var a;if(!((a=s.itemType)!=null&&a.toString()))return $.error("备忘类型不能为空");if(!s.content)return $.error("备忘内容不能为空");C(!0);let t={};t.content=s.content===(n==null?void 0:n.content)?null:s.content,t.itemType=s.itemType===(n==null?void 0:n.itemType)?null:s.itemType,t.id=n==null?void 0:n.id,await(n?U:Q)(t)&&(y(!1),i()),C(!1)},L=(t,r)=>{w(`${r}${s.content?"":`
`}`),h(!1)},A=(t,r)=>{r[0]&&(w(`${r.join("~")}${s.content?"":`
`}`),x(!1))},F=e.jsx(ee,{children:ae.map(t=>e.jsx(te,{span:3,onClick:()=>w(t),className:M.sign,children:t},t))}),w=t=>{var T;const r=((T=g.current)==null?void 0:T.resizableTextArea.textArea)??{selectionStart:-1,selectionEnd:-1},a=r.selectionStart,P=r.selectionEnd,b=s.content??"",N=b.slice(0,a),K=b.slice(P);c(d=>({...d,content:`${N}${t}${K}`})),window.setTimeout(()=>{var d;g.current&&((d=g.current)==null||d.resizableTextArea.textArea.setSelectionRange(a+t.length,a+t.length),g.current.focus())},100)},q=(t,r)=>v.info({title:t,style:{top:20},wrapClassName:M.externalImgModel,width:"100vh",okText:"关闭",maskClosable:!0,content:e.jsx("iframe",{src:r,title:t,allow:"clipboard-read; clipboard-write",style:{width:"100%",height:"100%"}})}),D=e.jsxs("div",{children:[e.jsx("p",{children:"● 点击插入时间/段,可插入时间/段在输入框光标所在位置"}),e.jsx("p",{children:"● 如果输入框本来是空的 插入后会多加一个换行"}),e.jsx("p",{children:"● 如果选中了文字 插入会覆盖哦"}),e.jsxs("p",{children:["● 插入的符号更多",e.jsx(m,{type:"link",href:"https://blog.csdn.net/weixin_46665865/article/details/126132912",style:{padding:0},target:"_blank",children:"参考这里"})]})]}),H=[...ce.map(({title:t,src:r},a)=>e.jsxs(m,{onClick:()=>q(t,r),children:["外部图床",a+1]},a)),e.jsx(S,{content:D,title:"帮助",children:e.jsx(m,{icon:e.jsx(V,{}),shape:"circle"})},"help"),e.jsx(S,{content:F,title:"插入符号",children:e.jsx(m,{icon:e.jsx(oe,{}),shape:"circle"})},"insertSymbol"),e.jsx(m,{onClick:()=>x(t=>!t)||h(!1),children:"插入日期段"},"RangeButt"),e.jsx(m,{onClick:()=>h(t=>!t)||x(!1),children:"插入日期"},"dateButt"),e.jsx(m,{onClick:y,children:"返回"},"back"),e.jsx(m,{type:"primary",onClick:I,loading:j,children:"提交"},"submit")];return e.jsxs(Y,{width:888,title:n?"编辑备忘":"新增备忘",open:o,onCancel:y,footer:H,children:[e.jsx("div",{className:"lrCenter",children:e.jsxs(p.Group,{onChange:t=>c({...s,itemType:t.target.value}),value:s==null?void 0:s.itemType,buttonStyle:"solid",style:{margin:5},children:[e.jsx(p.Button,{value:0,children:"普通"}),e.jsx(p.Button,{value:1,children:"循环"}),e.jsx(p.Button,{value:2,children:"长期"}),e.jsx(p.Button,{value:3,children:"紧急"}),e.jsx(p.Button,{value:5,children:"日记"}),e.jsx(p.Button,{value:6,children:"工作"}),e.jsx(p.Button,{value:7,children:"其他"})]})}),e.jsx(ie,{rows:14,showCount:!0,ref:g,maxLength:(s==null?void 0:s.itemType)===5?4e3:2e3,value:s==null?void 0:s.content,placeholder:"请输入备忘内容",onChange:t=>c({...s,content:t.target.value})}),e.jsx(B,{open:E,onChange:L,placement:"topRight",style:{left:480,top:30,height:20,visibility:"hidden"}}),e.jsx(B.RangePicker,{open:R,onChange:A,placement:"topRight",style:{left:100,height:20,display:R?"":"none"}},"dateRange")]})},ae=["●","𝟭、","𝟮、","𝟯、","𝟰、","𝟱、","𝟲、","𝟳、","𝟴、","𝟵、","𝟬、","♻","▣","〓","▬","█","▶","🞉","⚫","𖡎","𒈞","🡆","🡄","🢄","🢅","▛","▀","▜","𓇻","❖","◆","℃","𖤐","֎","𖠢","𖦹","𓃒","𐃶","𐙼","😶‍🌫️"],z=/(https?:\/\/[^\s]+)/g,ue=/\.(jpeg|jpg|gif|png|bmp|webp|svg)|ipfs/i,me=/\.(mp4|webm|ogg|mov)$/i,be=({children:o,linkImg:l,linkVideo:n})=>!o||typeof o!="string"?o:o.split(z).map((i,f)=>i.match(z)?l&&ue.test(i)?l(i,f):n&&me.test(i)?n(i,f):e.jsx("a",{href:i,target:"_blank",rel:"noopener noreferrer",children:i},f):i),Te=({content:o,keyword:l})=>{if(!o||!l)return o;const n=pe(l),i=new RegExp(`(${n})`,"gi"),f=o.split(i);let s=0;return e.jsx(e.Fragment,{children:f.map((c,j)=>e.jsx(J.Fragment,{children:c.toLowerCase()===l.toLowerCase()?e.jsx("b",{style:_[s++%_.length],children:c}):c},j))})},_=[{backgroundColor:"#0400ff29",color:"#000"},{backgroundColor:"#ff000029",color:"#000"}],pe=o=>o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");export{ve as F,Te as H,be as L,ae as s};
